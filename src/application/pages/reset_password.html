{{> _head}}
<main>
  <h1>{{title}}</h1>

  <form id="reset-password-form" data-testid="reset-password-form">
    <input id="password" type="text" name="password" data-testid="reset-password-password" />
    <ul id="password-error-messages" data-testid="password-error-messages"></ul>

    <input id="confirm-password" type="text" name="confirm-password" data-testid="reset-passowrd-confirm-password" />
    <ul id="confirm-password-error-messages" data-testid="confirm-password-error-messages"></ul>

    <button type="submit" data-testid="reset-password-submit">
      Resetar
    </button>
  </form>
</main>

<script>
  new Form(
    document.getElementById('reset-password-form'),
    [
      {
        input_element: document.getElementById('password'),
        error_message_element: document.getElementById('password-error-messages'),
        rules: ['required', 'min:8', 'password']
      },
      {
        input_element: document.getElementById('confirm-password'),
        error_message_element: document.getElementById('confirm-password-error-messages'),
        rules: ['required', 'min:8', 'password', 'equal:password']
      },
    ]
  ).setCustomSubmit(async function (e) {
    e.preventDefault();

    // TODO: create endpoint to reset password
    // const response = await fetch('/auth/passwords/{{user_id}}', {
    //   method: 'PUT',
    //   body: JSON.stringify({
    //     password: e.target.elements['password'].value,
    //   }),
    //   headers: {
    //     'Content-Type': 'application/json'
    //   }
    // });

    // if (response.status >= 400) {
    //   return;
    // }

    this.form_element.submit();
  }).init();
</script>
{{> _footer}}