{{> _head}}
<main>
  <h1>{{title}}</h1>

  <form id="login-form" method="post" action="/pages/login">
    <input type="email" name="email" id="email" />

    <input type="password" name="password" id="password" />

    <button type="submit">
      Login
    </button>
  </form>

  {{> components/test}}
</main>

<script>
  console.log(new Validator())
  const form = document.getElementById("login-form");
  form.addEventListener('submit', (e) => {
    e.preventDefault();

    grecaptcha.ready(async () => {
      const token = await grecaptcha.execute('6LdAc2UpAAAAAObuHow9pOS5dy0coRW11AKKiWJA', { action: 'submit' });
      console.log(token);
      console.log(e);

      const response = await fetch('/api/auth/captcha', {
        method: 'POST',
        body: JSON.stringify({ token }),
        headers: {
          'Content-Type': 'application/json'
        }
      });

      console.log(response.status);

      form.submit();
    });
  });
</script>
{{> _footer}}